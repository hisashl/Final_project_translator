{"version":3,"sources":["quill-editor.tsx"],"names":["QuillEditor","React","Component","constructor","props","initialHtml","import3rdParties","containerId","theme","background","color","placeholder","quill","id","modules","toolbar","customFonts","customStyles","defaultFontFamily","undefined","customJS","autoSize","JSON","stringify","clipboard","keyboard","libraries","editorId","fonts","backgroundColor","placeholderColor","obj","jsonString","_webview","current","postMessage","data","message","parse","event","toMessage","nativeEvent","response","key","_promises","find","x","type","setState","height","_handlers","filter","forEach","item","handler","resolve","webview","onMessage","post","command","Platform","OS","requestFocus","postAwait","enable","value","name","index","length","focus","source","text","formats","delta","push","findIndex","splice","html","content","style","syntheticEvent","console","warn","createRef","state","webviewContent","getInitalHtml","onSelectionChange","onEditorChange","onTextChange","onHtmlChange","onDimensionsChange","onBlur","onFocus","on","getKey","timestamp","Date","getUTCMilliseconds","Math","random","resolveFn","promise","Promise","resp","render","container","loading","renderWebview","ContainerComponent","View","styles","webView","StyleSheet","create","flexGrow","borderWidth"],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport {\r\n  WebView,\r\n  WebViewMessageEvent,\r\n  WebViewProps,\r\n} from 'react-native-webview';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  StyleProp,\r\n  ViewStyle,\r\n  Platform,\r\n} from 'react-native';\r\nimport { createHtml } from '../utils/editor-utils';\r\nimport type {\r\n  CustomFont,\r\n  EditorMessage,\r\n  EditorResponse,\r\n  GetLeafResponse,\r\n  QuillConfig,\r\n} from '../types';\r\nimport type {\r\n  EditorEventHandler,\r\n  EditorEventType,\r\n  SelectionChangeData,\r\n  EditorChangeData,\r\n  TextChangeData,\r\n  HtmlChangeData,\r\n  DimensionsChangeData,\r\n  Range,\r\n} from '../constants/editor-event';\r\nimport { Loading } from './loading';\r\n\r\nexport interface EditorState {\r\n  webviewContent: string | null;\r\n  height?: number;\r\n}\r\n\r\nexport interface EditorProps {\r\n  autoSize?: boolean;\r\n  style?: StyleProp<ViewStyle>;\r\n  quill?: QuillConfig;\r\n  customFonts?: Array<CustomFont>;\r\n  defaultFontFamily?: string;\r\n  initialHtml?: string;\r\n  customStyles?: string[];\r\n  import3rdParties?: 'local' | 'cdn';\r\n  containerId?: string;\r\n  theme?: { background: string; color: string; placeholder: string };\r\n  loading?: string | React.ReactNode;\r\n  container?: boolean | React.ComponentType;\r\n  onSelectionChange?: (data: SelectionChangeData) => void;\r\n  onTextChange?: (data: TextChangeData) => void;\r\n  onHtmlChange?: (data: HtmlChangeData) => void;\r\n  onEditorChange?: (data: EditorChangeData) => void;\r\n  onDimensionsChange?: (data: DimensionsChangeData) => void;\r\n  webview?: WebViewProps;\r\n  onBlur?: () => void;\r\n  onFocus?: () => void;\r\n  customJS?: string;\r\n}\r\n\r\nexport default class QuillEditor extends React.Component<\r\n  EditorProps,\r\n  EditorState\r\n> {\r\n  private _webview: React.RefObject<WebView>;\r\n  private _handlers: Array<{\r\n    event: EditorEventType;\r\n    handler: EditorEventHandler;\r\n  }>;\r\n  private _promises: Array<EditorResponse>;\r\n\r\n  constructor(props: EditorProps) {\r\n    super(props);\r\n    this._webview = React.createRef();\r\n    this.state = {\r\n      webviewContent: this.getInitalHtml(),\r\n    };\r\n\r\n    this._handlers = [];\r\n    this._promises = [];\r\n    const {\r\n      onSelectionChange,\r\n      onEditorChange,\r\n      onTextChange,\r\n      onHtmlChange,\r\n      onDimensionsChange,\r\n      onBlur,\r\n      onFocus,\r\n    } = this.props;\r\n    if (onSelectionChange) {\r\n      this.on('selection-change', onSelectionChange);\r\n    }\r\n    if (onEditorChange) {\r\n      this.on('editor-change', onEditorChange);\r\n    }\r\n    if (onTextChange) {\r\n      this.on('text-change', onTextChange);\r\n    }\r\n    if (onHtmlChange) {\r\n      this.on('html-change', onHtmlChange);\r\n    }\r\n    if (onDimensionsChange) {\r\n      this.on('dimensions-change', onDimensionsChange);\r\n    }\r\n    if (onBlur) {\r\n      this.on('blur', onBlur);\r\n    }\r\n    if (onFocus) {\r\n      this.on('focus', onFocus);\r\n    }\r\n  }\r\n\r\n  private getInitalHtml = (): string => {\r\n    const {\r\n      initialHtml = '',\r\n      import3rdParties = 'local',\r\n      containerId = 'standalone-container',\r\n      theme = {\r\n        background: 'white',\r\n        color: 'rgb(32, 35, 42)',\r\n        placeholder: 'rgba(0,0,0,0.6)',\r\n      },\r\n      quill = {\r\n        id: 'editor-container',\r\n        placeholder: 'write here!',\r\n        modules: {\r\n          toolbar: false,\r\n        },\r\n        theme: 'snow',\r\n      },\r\n      customFonts = [],\r\n      customStyles = [],\r\n      defaultFontFamily = undefined,\r\n      customJS = '',\r\n    } = this.props;\r\n\r\n    return createHtml({\r\n      initialHtml,\r\n      autoSize: this.props.autoSize,\r\n      placeholder: quill.placeholder,\r\n      theme: quill.theme ? quill.theme : 'snow',\r\n      toolbar: JSON.stringify(quill.modules?.toolbar),\r\n      clipboard: quill.modules?.clipboard,\r\n      keyboard: quill.modules?.keyboard,\r\n      libraries: import3rdParties,\r\n      editorId: quill.id ? quill.id : 'editor-container',\r\n      defaultFontFamily,\r\n      containerId,\r\n      color: theme.color,\r\n      fonts: customFonts,\r\n      backgroundColor: theme.background,\r\n      placeholderColor: theme.placeholder,\r\n      customStyles,\r\n      customJS,\r\n    });\r\n  };\r\n\r\n  private getKey(): string {\r\n    var timestamp = new Date().getUTCMilliseconds();\r\n    return `${timestamp}${Math.random()}`;\r\n  }\r\n\r\n  private postAwait<T>(data: any): Promise<T> {\r\n    const key = this.getKey();\r\n    let resolveFn: (value: T | PromiseLike<T>) => void;\r\n    resolveFn = () => {};\r\n    const promise = new Promise<T>((resolve) => {\r\n      resolveFn = resolve;\r\n    });\r\n\r\n    const resp: EditorResponse = {\r\n      key,\r\n      resolve: resolveFn,\r\n    };\r\n\r\n    this._promises.push(resp);\r\n    this.post({ ...data, key });\r\n\r\n    return promise;\r\n  }\r\n\r\n  private post = (obj: object) => {\r\n    const jsonString = JSON.stringify(obj);\r\n    this._webview.current?.postMessage(jsonString);\r\n  };\r\n\r\n  private toMessage = (data: string): EditorMessage => {\r\n    const message: EditorMessage = JSON.parse(data);\r\n    return message;\r\n  };\r\n\r\n  private onMessage = (event: WebViewMessageEvent) => {\r\n    const message = this.toMessage(event.nativeEvent.data);\r\n    const { autoSize } = this.props;\r\n    const response = message.key\r\n      ? this._promises.find((x) => x.key === message.key)\r\n      : undefined;\r\n    switch (message.type) {\r\n      case 'dimensions-change':\r\n        if (autoSize === true) this.setState({ height: message.data.height });\r\n        this._handlers\r\n          .filter((x) => x.event === message.type)\r\n          .forEach((item) => item.handler(message.data));\r\n        break;\r\n      case 'format-change':\r\n      case 'text-change':\r\n      case 'selection-change':\r\n      case 'html-change':\r\n      case 'editor-change':\r\n      case 'blur':\r\n      case 'focus':\r\n        this._handlers\r\n          .filter((x) => x.event === message.type)\r\n          .forEach((item) => item.handler(message.data));\r\n        break;\r\n      case 'has-focus':\r\n      case 'get-contents':\r\n      case 'set-contents':\r\n      case 'get-text':\r\n      case 'get-length':\r\n      case 'get-bounds':\r\n      case 'get-selection':\r\n      case 'get-dimensions':\r\n      case 'get-html':\r\n      case 'get-format':\r\n      case 'get-leaf':\r\n      case 'remove-format':\r\n      case 'format-text':\r\n        if (response) {\r\n          response.resolve(message.data);\r\n          this._promises = this._promises.filter((x) => x.key !== message.key);\r\n        }\r\n        break;\r\n      default:\r\n        // Allow catching messages using the passed webview props\r\n        if (this.props.webview?.onMessage) {\r\n          this.props.webview?.onMessage(event);\r\n        }\r\n    }\r\n  };\r\n\r\n  blur = () => {\r\n    this.post({ command: 'blur' });\r\n  };\r\n\r\n  focus = () => {\r\n    this.post({ command: 'focus' });\r\n\r\n    if (Platform.OS === 'android') {\r\n      this._webview.current?.requestFocus();\r\n    }\r\n  };\r\n\r\n  hasFocus = (): Promise<boolean> => {\r\n    return this.postAwait<any>({ command: 'hasFocus' });\r\n  };\r\n\r\n  enable = (enable = true) => {\r\n    this.post({ command: 'enable', value: enable });\r\n  };\r\n\r\n  disable = () => {\r\n    this.post({ command: 'enable', value: false });\r\n  };\r\n\r\n  update = () => {\r\n    this.post({ command: 'update' });\r\n  };\r\n\r\n  format = (name: string, value: any) => {\r\n    this.post({ command: 'format', name, value });\r\n  };\r\n\r\n  deleteText = (index: number, length: number) => {\r\n    this.post({ command: 'deleteText', index, length });\r\n  };\r\n\r\n  removeFormat = (index: number, length: number) => {\r\n    return this.postAwait({ command: 'removeFormat', index, length });\r\n  };\r\n\r\n  getDimensions = (): Promise<any> => {\r\n    return this.postAwait<any>({ command: 'getDimensions' });\r\n  };\r\n\r\n  getContents = (index?: number, length?: number): Promise<any> => {\r\n    return this.postAwait<any>({ command: 'getContents', index, length });\r\n  };\r\n\r\n  getHtml = (): Promise<string> => {\r\n    return this.postAwait<any>({ command: 'getHtml' });\r\n  };\r\n\r\n  getLength = (): Promise<number> => {\r\n    return this.postAwait<any>({ command: 'getLength' });\r\n  };\r\n\r\n  getText = (index?: number, length?: number): Promise<string> => {\r\n    return this.postAwait<any>({ command: 'getText', index, length });\r\n  };\r\n\r\n  getBounds = (\r\n    index: number,\r\n    length?: number\r\n  ): Promise<{ left: number; top: number; height: number; width: number }> => {\r\n    return this.postAwait<any>({ command: 'getBounds', index, length });\r\n  };\r\n\r\n  getSelection = (focus: boolean = false): Promise<Range> => {\r\n    return this.postAwait<any>({ command: 'getSelection', focus });\r\n  };\r\n\r\n  setSelection = (index: number, length?: number, source?: String) => {\r\n    this.post({ command: 'setSelection', index, length, source });\r\n  };\r\n\r\n  insertEmbed = (index: number, type: string, value: any) => {\r\n    this.post({ command: 'insertEmbed', index, type, value });\r\n  };\r\n\r\n  insertText = (index: number, text: string, formats?: Record<string, any>) => {\r\n    this.post({ command: 'insertText', index, text, formats });\r\n  };\r\n\r\n  setContents = (delta: any): Promise<any> => {\r\n    return this.postAwait<any>({ command: 'setContents', delta });\r\n  };\r\n\r\n  setText = (text: string) => {\r\n    this.post({ command: 'setText', text });\r\n  };\r\n\r\n  setPlaceholder = (text: string) => {\r\n    this.post({ command: 'setPlaceholder', text });\r\n  };\r\n\r\n  updateContents = (delta: any) => {\r\n    this.post({ command: 'updateContents', delta });\r\n  };\r\n\r\n  getFormat = (\r\n    index: { index: number; length: number } | number,\r\n    length?: number\r\n  ): Promise<Record<string, unknown>> => {\r\n    return this.postAwait({ command: 'getFormat', index, length });\r\n  };\r\n\r\n  getLeaf = (index: number): Promise<GetLeafResponse | null> => {\r\n    return this.postAwait({ command: 'getLeaf', index });\r\n  };\r\n\r\n  formatText = (\r\n    index: number,\r\n    length: number,\r\n    formats: Record<string, unknown>,\r\n    source: string = 'api'\r\n  ): Promise<any> => {\r\n    return this.postAwait({\r\n      command: 'formatText',\r\n      index,\r\n      length,\r\n      formats,\r\n      source,\r\n    });\r\n  };\r\n\r\n  on = (event: EditorEventType, handler: EditorEventHandler) => {\r\n    this._handlers.push({ event, handler });\r\n  };\r\n\r\n  off = (event: EditorEventType, handler: Function) => {\r\n    const index = this._handlers.findIndex(\r\n      (x) => x.event === event && x.handler === handler\r\n    );\r\n    if (index > -1) {\r\n      this._handlers.splice(index, 1);\r\n    }\r\n  };\r\n\r\n  dangerouslyPasteHTML = (index: number, html: string) => {\r\n    this.post({ command: 'dangerouslyPasteHTML', index, html });\r\n  };\r\n\r\n  renderWebview = (\r\n    content: string,\r\n    style: StyleProp<ViewStyle>,\r\n    props: WebViewProps = {}\r\n  ) => (\r\n    <WebView\r\n      scrollEnabled={false}\r\n      nestedScrollEnabled={true}\r\n      hideKeyboardAccessoryView={true}\r\n      keyboardDisplayRequiresUserAction={false}\r\n      originWhitelist={['*']}\r\n      style={style}\r\n      onError={(syntheticEvent) => {\r\n        const { nativeEvent } = syntheticEvent;\r\n        console.warn('WebView error: ', nativeEvent);\r\n      }}\r\n      allowFileAccess={true}\r\n      domStorageEnabled={false}\r\n      automaticallyAdjustContentInsets={true}\r\n      bounces={false}\r\n      dataDetectorTypes=\"none\"\r\n      {...props}\r\n      javaScriptEnabled={true}\r\n      source={{ html: content }}\r\n      ref={this._webview}\r\n      onMessage={this.onMessage}\r\n    />\r\n  );\r\n\r\n  render() {\r\n    const { webviewContent, height } = this.state;\r\n    const {\r\n      style,\r\n      webview,\r\n      container = false,\r\n      loading = 'Please Wait ...',\r\n      autoSize = false,\r\n    } = this.props;\r\n    if (container === false) {\r\n      if (!webviewContent) return <Text>Please wait...</Text>;\r\n      return this.renderWebview(webviewContent, style, webview);\r\n    } else {\r\n      const ContainerComponent = container === true ? View : container;\r\n      return (\r\n        <ContainerComponent\r\n          style={[style, autoSize && height ? { height } : {}]}\r\n        >\r\n          {webviewContent ? (\r\n            this.renderWebview(webviewContent, styles.webView, webview)\r\n          ) : typeof loading === 'string' ? (\r\n            <Loading text={loading} />\r\n          ) : (\r\n            loading\r\n          )}\r\n        </ContainerComponent>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nlet styles = StyleSheet.create({\r\n  webView: {\r\n    flexGrow: 1,\r\n    borderWidth: 0,\r\n  },\r\n});\r\n"]}