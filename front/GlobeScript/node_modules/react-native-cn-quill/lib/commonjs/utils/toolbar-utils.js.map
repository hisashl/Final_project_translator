{"version":3,"sources":["toolbar-utils.ts"],"names":["getToolbarData","options","customIcons","defaultFontFamily","iconSet","icons","defaultIcons","isSingle","length","Array","isArray","set","createToolSet","push","i","opt","console","log","tools","ic","format","formats","find","f","name","type","formatType","toggle","formatIcon","source","valueOff","valueOn","keys","Object","values","j","key","value","listItems","allowCustoms","map","v","def","defaults","formatValueType","text","filter","indexOf","select","x","icon","undefined","color","fIcon"],"mappings":"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","sourcesContent":["import { formats, formatType, formatValueType } from '../constants/formats';\r\nimport type {\r\n  ColorListData,\r\n  formatDefault,\r\n  TextListData,\r\n  ToggleData,\r\n} from '../types';\r\nimport { icons as defaultIcons } from '../constants/icons';\r\nimport { getFontName } from './editor-utils';\r\n\r\nexport const getToolbarData = (\r\n  options: Array<Array<string | object> | string | object>,\r\n  customIcons?: Record<string, any>,\r\n  defaultFontFamily?: string\r\n): Array<Array<ToggleData | TextListData | ColorListData>> => {\r\n  let iconSet: Array<Array<ToggleData | TextListData | ColorListData>> = [];\r\n  const icons = customIcons\r\n    ? { ...defaultIcons, ...customIcons }\r\n    : defaultIcons;\r\n\r\n  const isSingle: boolean = !(options.length > 0 && Array.isArray(options[0]));\r\n  if (isSingle) {\r\n    const set = createToolSet(options, icons);\r\n    iconSet.push(set);\r\n  } else {\r\n    for (let i = 0; i < options.length; i++) {\r\n      const opt = options[i];\r\n      if (Array.isArray(opt)) {\r\n        const set = createToolSet(opt, icons, defaultFontFamily);\r\n        iconSet.push(set);\r\n      } else\r\n        console.log(opt, 'is not an array, you should pass it as an array');\r\n    }\r\n  }\r\n\r\n  return iconSet;\r\n};\r\n\r\nconst createToolSet = (\r\n  tools: Array<string | object>,\r\n  icons: Record<string, any>,\r\n  defaultFontFamily?: string\r\n): Array<ToggleData | TextListData | ColorListData> => {\r\n  let ic: Array<ToggleData | TextListData | ColorListData> = [];\r\n  for (let i = 0; i < tools.length; i++) {\r\n    const opt = tools[i];\r\n\r\n    if (typeof opt === 'string') {\r\n      const format = formats.find((f) => f.name === opt);\r\n      if ((format && format.type === formatType.toggle) || !format) {\r\n        const formatIcon = icons[opt];\r\n        if (formatIcon) {\r\n          ic.push({\r\n            name: opt,\r\n            source: formatIcon,\r\n            valueOff: false,\r\n            valueOn: true,\r\n            type: formatType.toggle,\r\n          } as ToggleData);\r\n        } else {\r\n          ic.push({\r\n            name: opt,\r\n            valueOff: false,\r\n            valueOn: true,\r\n            type: formatType.toggle,\r\n          } as ToggleData);\r\n        }\r\n      }\r\n    } else if (typeof opt === 'object' && opt !== null) {\r\n      const keys = Object.keys(opt);\r\n      const values = Object.values(opt);\r\n      for (let j = 0; j < keys.length; j++) {\r\n        const key = keys[j];\r\n        const value = values[j];\r\n        const format = formats.find((f) => f.name === key);\r\n        if (typeof value === 'string' || typeof value === 'number') {\r\n          const formatIcon = icons[key][value];\r\n          if (formatIcon) {\r\n            ic.push({\r\n              name: key,\r\n              source: formatIcon,\r\n              valueOff: false,\r\n              valueOn: value,\r\n              type: formatType.toggle,\r\n            } as ToggleData);\r\n          } else {\r\n            ic.push({\r\n              name: key,\r\n              valueOff: false,\r\n              valueOn: value,\r\n              type: formatType.toggle,\r\n            } as ToggleData);\r\n          }\r\n        } else if (Array.isArray(value)) {\r\n          const formatIcon = icons[key];\r\n          let listItems: formatDefault[] = [];\r\n          if ((!format || format.allowCustoms === true) && value.length > 0) {\r\n            listItems = value.map((v) => {\r\n              let def = format?.defaults?.find(\r\n                (f) => f.value === (v !== '' ? v : false)\r\n              );\r\n              if (key === 'font' && defaultFontFamily && def?.value === false) {\r\n                def.name = defaultFontFamily;\r\n              }\r\n              return def\r\n                ? def\r\n                : ({\r\n                    name: v,\r\n                    value:\r\n                      key === 'font' && v !== false && v !== ''\r\n                        ? getFontName(v)\r\n                        : v,\r\n                    type: formatValueType.text,\r\n                  } as formatDefault);\r\n            });\r\n          } else if (format?.defaults && value.length === 0) {\r\n            listItems = format.defaults;\r\n          } else if (format?.defaults && value.length > 0) {\r\n            listItems = format.defaults.filter(\r\n              (f) => value.indexOf(f.value) !== -1\r\n            );\r\n          }\r\n          if (listItems.length > 0) {\r\n            if (!format || format.type === formatType.select) {\r\n              ic.push({\r\n                name: key,\r\n                values: listItems.map((x) => {\r\n                  let icon =\r\n                    x.type === formatValueType.icon\r\n                      ? x.value === false\r\n                        ? icons[key]['']\r\n                        : typeof x.value === 'string'\r\n                        ? icons[key][x.value]\r\n                        : undefined\r\n                      : undefined;\r\n\r\n                  return {\r\n                    name: x.name,\r\n                    valueOff: false,\r\n                    valueOn: x.value,\r\n                    source: icon,\r\n                    type: (\r\n                      x.type === formatValueType.icon && icon ? true : false\r\n                    )\r\n                      ? formatType.icon\r\n                      : formatType.toggle,\r\n                  } as ToggleData;\r\n                }),\r\n                type: formatType.select,\r\n              } as TextListData);\r\n            } else {\r\n              ic.push({\r\n                name: key,\r\n                source: formatIcon,\r\n                values: listItems.map(\r\n                  (x) =>\r\n                    ({\r\n                      name: x.name,\r\n                      valueOff: false,\r\n                      valueOn: x.value,\r\n                      type: formatType.color,\r\n                    } as ToggleData)\r\n                ),\r\n                type: formatType.color,\r\n              } as ColorListData);\r\n            }\r\n          } else {\r\n            const fIcon = icons[key];\r\n            if (fIcon) {\r\n              ic.push({\r\n                name: key,\r\n                source: fIcon,\r\n                valueOff: false,\r\n                valueOn: true,\r\n                type: formatType.toggle,\r\n              } as ToggleData);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return ic;\r\n};\r\n"]}