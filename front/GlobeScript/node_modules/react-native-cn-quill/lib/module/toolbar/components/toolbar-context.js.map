{"version":3,"sources":["toolbar-context.tsx"],"names":["React","Component","useContext","StyleSheet","Animated","Easing","lightTheme","ToolbarContext","createContext","apply","show","hide","selectedFormats","open","isSelected","theme","options","selectionName","getSelected","ToolbarConsumer","Consumer","ToolbarProvider","constructor","props","name","state","isAnimating","setState","timing","animatedValue","toValue","size","duration","easing","sin","useNativeDriver","start","linear","value","selected","format","custom","actions","find","x","indexOf","handler","Value","componentDidMount","render","children","styles","defaultStyles","makeStyles","rootStyle","toolbar","provider","root","height","create","borderTopWidth","borderLeftWidth","borderRightWidth","borderColor","color","position","backgroundColor","background","width","withToolbar","MyComponent","WrappedComponent","forwardRef","ref","context","useToolbar"],"mappings":"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","sourcesContent":["import React, { Component, useContext } from 'react';\r\nimport { StyleSheet, Animated, Easing } from 'react-native';\r\nimport { lightTheme } from '../../constants/themes';\r\nimport type {\r\n  CustomStyles,\r\n  ToggleData,\r\n  ToolbarCustom,\r\n  ToolbarTheme,\r\n} from '../../types';\r\n\r\nexport interface ContextProps {\r\n  apply: (name: string, value: any) => void;\r\n  selectedFormats: object;\r\n  isSelected: (name: string, value: any) => boolean;\r\n  theme: ToolbarTheme;\r\n  show: (name: string, options: Array<ToggleData>) => void;\r\n  hide: Function;\r\n  open: boolean;\r\n  options: Array<ToggleData>;\r\n  selectionName: string;\r\n  getSelected: (name: string) => any;\r\n  styles?: CustomStyles;\r\n}\r\n\r\nconst ToolbarContext = React.createContext<ContextProps>({\r\n  apply: () => {},\r\n  show: () => {},\r\n  hide: () => {},\r\n  selectedFormats: {},\r\n  open: false,\r\n  isSelected: () => false,\r\n  theme: lightTheme,\r\n  options: [],\r\n  selectionName: '',\r\n  getSelected: () => false,\r\n});\r\n\r\nexport const ToolbarConsumer = ToolbarContext.Consumer;\r\n\r\ninterface ProviderProps {\r\n  format: Function;\r\n  selectedFormats: Record<string, any>;\r\n  theme: ToolbarTheme;\r\n  custom?: ToolbarCustom;\r\n  styles?: CustomStyles;\r\n}\r\n\r\ninterface ProviderState {\r\n  open: boolean;\r\n  isAnimating: boolean;\r\n  options: Array<ToggleData>;\r\n  name: string;\r\n}\r\n\r\nexport class ToolbarProvider extends Component<ProviderProps, ProviderState> {\r\n  animatedValue: Animated.Value;\r\n  constructor(props: ProviderProps) {\r\n    super(props);\r\n    this.state = {\r\n      open: false,\r\n      isAnimating: false,\r\n      options: [],\r\n      name: '',\r\n    };\r\n    this.animatedValue = new Animated.Value(0);\r\n  }\r\n\r\n  show = (name: string, options: Array<ToggleData>) => {\r\n    if (this.state.isAnimating) return;\r\n\r\n    const { theme } = this.props;\r\n    if (theme) {\r\n      this.setState({ options, name, isAnimating: true }, () => {\r\n        Animated.timing(this.animatedValue, {\r\n          toValue: 2 * theme.size + 14,\r\n          duration: 200,\r\n          easing: Easing.sin,\r\n          useNativeDriver: false,\r\n        }).start(() => this.setState({ open: true, isAnimating: false }));\r\n      });\r\n    }\r\n  };\r\n\r\n  hide = () => {\r\n    if (this.state.isAnimating) return;\r\n    const { theme } = this.props;\r\n    if (theme) {\r\n      this.setState({ isAnimating: true }, () => {\r\n        Animated.timing(this.animatedValue, {\r\n          toValue: theme.size + 10,\r\n          duration: 200,\r\n          easing: Easing.linear,\r\n          useNativeDriver: false,\r\n        }).start(() => {\r\n          this.setState({\r\n            name: '',\r\n            open: false,\r\n            options: [],\r\n            isAnimating: false,\r\n          });\r\n        });\r\n      });\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    const { theme } = this.props;\r\n    this.animatedValue = new Animated.Value(theme.size + 10);\r\n  }\r\n\r\n  isSelected = (name: string, value: any = true): boolean => {\r\n    const { selectedFormats } = this.props;\r\n    const selected = selectedFormats[name];\r\n    return selected ? selected === value : value === false;\r\n  };\r\n\r\n  getSelected = (name: string): any => {\r\n    const { selectedFormats } = this.props;\r\n    const selected = selectedFormats[name];\r\n    return selected ? selected : false;\r\n  };\r\n\r\n  apply = (name: string, value: any) => {\r\n    const { format, custom } = this.props;\r\n\r\n    if (custom?.actions) custom.actions.find((x) => x === name);\r\n    if (custom?.actions && custom?.actions?.indexOf(name) > -1) {\r\n      if (custom?.handler) custom.handler(name, value);\r\n    } else {\r\n      format(name, value);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { selectedFormats, children, theme, styles } = this.props;\r\n    const { open, options, name } = this.state;\r\n    const defaultStyles = makeStyles(theme);\r\n    const rootStyle = styles?.toolbar?.provider\r\n      ? styles?.toolbar?.provider(defaultStyles.root)\r\n      : defaultStyles.root;\r\n    return (\r\n      <ToolbarContext.Provider\r\n        value={{\r\n          selectedFormats,\r\n          apply: this.apply,\r\n          isSelected: this.isSelected,\r\n          theme,\r\n          open,\r\n          show: this.show,\r\n          hide: this.hide,\r\n          getSelected: this.getSelected,\r\n          selectionName: name,\r\n          options,\r\n          styles,\r\n        }}\r\n      >\r\n        <Animated.View\r\n          style={[\r\n            rootStyle,\r\n            {\r\n              height: this.animatedValue,\r\n            },\r\n          ]}\r\n        >\r\n          {children}\r\n        </Animated.View>\r\n      </ToolbarContext.Provider>\r\n    );\r\n  }\r\n}\r\n\r\nconst makeStyles = (theme: ToolbarTheme) =>\r\n  StyleSheet.create({\r\n    root: {\r\n      borderTopWidth: 1,\r\n      borderLeftWidth: 1,\r\n      borderRightWidth: 1,\r\n      borderColor: theme.color,\r\n      position: 'relative',\r\n      backgroundColor: theme.background,\r\n      width: '100%',\r\n    },\r\n  });\r\n\r\nexport const withToolbar = (MyComponent: any) => {\r\n  const WrappedComponent = React.forwardRef((props, ref) => (\r\n    <ToolbarContext.Consumer>\r\n      {(context) => (\r\n        <MyComponent\r\n          {...props}\r\n          ref={ref}\r\n          apply={context.apply}\r\n          selectedFormats={context.selectedFormats}\r\n        />\r\n      )}\r\n    </ToolbarContext.Consumer>\r\n  ));\r\n\r\n  return WrappedComponent;\r\n};\r\n\r\nexport const useToolbar = (): ContextProps => useContext(ToolbarContext);\r\n"]}