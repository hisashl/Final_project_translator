{"version":3,"file":"Thumb.js","names":["_react","_interopRequireDefault","require","_reactNativeReanimated","_index","_AppContext","_styles","_index2","obj","__esModule","default","Thumb","handleStyle","innerStyle","style","thumbColor","renderThumb","RenderThumb","thumbShape","thumbSize","vertical","adaptSpectrum","channel","overrideHSV","width","height","borderRadius","hueValue","saturationValue","brightnessValue","alphaValue","value","usePickerContext","hue","saturation","brightness","alpha","resultColor","useSharedValue","solidColor","useAnimatedStyle","backgroundColor","adaptiveColor","getColorForAdaptiveColor","h","s","v","useDerivedValue","colorKit","runOnUI","HEX","compareColor1","compareColor2","contrast","contrastRatio","reversedColor","thumbProps","createElement","positionStyle","styles","handle","initialColor","currentColor","thumb_Shape","toLowerCase","charAt","toUpperCase","slice","BuiltinThumbs","SelectedThumb","Ring"],"sources":["../../../src/components/Thumb/Thumb.tsx"],"sourcesContent":["import React from 'react';\nimport { useAnimatedStyle, useDerivedValue, useSharedValue } from 'react-native-reanimated';\n\nimport colorKit from '../../colorKit/index';\nimport usePickerContext from '../../AppContext';\nimport { styles } from '../../styles';\nimport BuiltinThumbs from './BuiltinThumbs/index';\n\nimport type { BuiltinThumbsProps, ThumbProps } from '../../types';\n\nexport default function Thumb({\n  handleStyle,\n  innerStyle,\n  style,\n  thumbColor,\n  renderThumb: RenderThumb,\n  thumbShape = 'ring',\n  thumbSize,\n  vertical = false,\n  adaptSpectrum,\n  channel,\n  overrideHSV,\n}: ThumbProps) {\n  const { width, height, borderRadius } = { width: thumbSize, height: thumbSize, borderRadius: thumbSize / 2 };\n  const { hueValue, saturationValue, brightnessValue, alphaValue, value } = usePickerContext();\n\n  const hue = overrideHSV?.hue ?? hueValue,\n    saturation = overrideHSV?.saturation ?? saturationValue,\n    brightness = overrideHSV?.brightness ?? brightnessValue,\n    alpha = overrideHSV?.alpha ?? alphaValue;\n\n  const resultColor = useSharedValue('#ffffff');\n  const solidColor = useAnimatedStyle(() => ({ backgroundColor: thumbColor ?? resultColor.value }), [resultColor]);\n  const adaptiveColor = useSharedValue<'#000000' | '#ffffff'>('#ffffff');\n\n  /**\n   * Get the current color and calculate its contrast ratio against white or black, depending on the channel and whether\n   * 'adaptSpectrum' is enabled\n   */\n  const getColorForAdaptiveColor = () => {\n    'worklet';\n    if (adaptSpectrum) {\n      if (channel === 'a') {\n        if (alpha.value > 0.5) return { h: hue.value, s: saturation.value, v: brightness.value };\n        return { h: 0, s: 0, v: 70 };\n      }\n      return { h: hue.value, s: saturation.value, v: brightness.value };\n    }\n\n    if (channel === 'h') return { h: hue.value, s: 100, v: 100 };\n    if (channel === 'v') return { h: hue.value, s: 100, v: brightness.value };\n    if (channel === 's') return { h: hue.value, s: saturation.value, v: 70 };\n    if (channel === 'a') return { h: hue.value, s: alpha.value * 100, v: 70 };\n    return { h: hue.value, s: saturation.value, v: brightness.value };\n  };\n\n  // When the values of channels change\n  useDerivedValue(() => {\n    alpha.value; // to track alpha changes too;\n    resultColor.value = colorKit.runOnUI().HEX({ h: hue.value, s: saturation.value, v: brightness.value });\n\n    // calculate the contrast ratio\n    const compareColor1 = getColorForAdaptiveColor();\n    const compareColor2 = adaptiveColor.value === '#000000' ? { h: 0, s: 0, v: 0 } : { h: 0, s: 0, v: 100 };\n    const contrast = colorKit.runOnUI().contrastRatio(compareColor1, compareColor2);\n    const reversedColor = adaptiveColor.value === '#ffffff' ? '#000000' : '#ffffff';\n    adaptiveColor.value = contrast < 4.5 ? reversedColor : adaptiveColor.value;\n  }, [alpha, hue, saturation, brightness]);\n\n  const thumbProps: BuiltinThumbsProps = {\n    width,\n    height,\n    borderRadius,\n    vertical,\n    solidColor,\n    adaptiveColor,\n    handleStyle,\n    innerStyle,\n    style,\n    thumbColor,\n  };\n\n  // render a custom thumb\n  if (RenderThumb)\n    return (\n      <RenderThumb\n        positionStyle={[styles.handle, handleStyle]}\n        width={width}\n        height={height}\n        initialColor={value}\n        currentColor={resultColor}\n        adaptiveColor={adaptiveColor}\n      />\n    );\n\n  // normalize 'thumbShape' string to match 'BuiltinThumbs' keys.\n  const thumb_Shape = (thumbShape.toLowerCase().charAt(0).toUpperCase() + thumbShape.slice(1)) as keyof typeof BuiltinThumbs;\n\n  if (thumb_Shape in BuiltinThumbs) {\n    const SelectedThumb = BuiltinThumbs[thumb_Shape];\n    return <SelectedThumb {...thumbProps} />;\n  }\n\n  // default to the 'Ring' thumb\n  return <BuiltinThumbs.Ring {...thumbProps} />;\n}\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,sBAAA,GAAAD,OAAA;AAEA,IAAAE,MAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,WAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,OAAA,GAAAJ,OAAA;AACA,IAAAK,OAAA,GAAAN,sBAAA,CAAAC,OAAA;AAAkD,SAAAD,uBAAAO,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAInC,SAASG,KAAKA,CAAC;EAC5BC,WAAW;EACXC,UAAU;EACVC,KAAK;EACLC,UAAU;EACVC,WAAW,EAAEC,WAAW;EACxBC,UAAU,GAAG,MAAM;EACnBC,SAAS;EACTC,QAAQ,GAAG,KAAK;EAChBC,aAAa;EACbC,OAAO;EACPC;AACU,CAAC,EAAE;EACb,MAAM;IAAEC,KAAK;IAAEC,MAAM;IAAEC;EAAa,CAAC,GAAG;IAAEF,KAAK,EAAEL,SAAS;IAAEM,MAAM,EAAEN,SAAS;IAAEO,YAAY,EAAEP,SAAS,GAAG;EAAE,CAAC;EAC5G,MAAM;IAAEQ,QAAQ;IAAEC,eAAe;IAAEC,eAAe;IAAEC,UAAU;IAAEC;EAAM,CAAC,GAAG,IAAAC,mBAAgB,EAAC,CAAC;EAE5F,MAAMC,GAAG,GAAG,CAAAV,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEU,GAAG,KAAIN,QAAQ;IACtCO,UAAU,GAAG,CAAAX,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEW,UAAU,KAAIN,eAAe;IACvDO,UAAU,GAAG,CAAAZ,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEY,UAAU,KAAIN,eAAe;IACvDO,KAAK,GAAG,CAAAb,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEa,KAAK,KAAIN,UAAU;EAE1C,MAAMO,WAAW,GAAG,IAAAC,qCAAc,EAAC,SAAS,CAAC;EAC7C,MAAMC,UAAU,GAAG,IAAAC,uCAAgB,EAAC,OAAO;IAAEC,eAAe,EAAE1B,UAAU,IAAIsB,WAAW,CAACN;EAAM,CAAC,CAAC,EAAE,CAACM,WAAW,CAAC,CAAC;EAChH,MAAMK,aAAa,GAAG,IAAAJ,qCAAc,EAAwB,SAAS,CAAC;;EAEtE;AACF;AACA;AACA;EACE,MAAMK,wBAAwB,GAAGA,CAAA,KAAM;IACrC,SAAS;;IACT,IAAItB,aAAa,EAAE;MACjB,IAAIC,OAAO,KAAK,GAAG,EAAE;QACnB,IAAIc,KAAK,CAACL,KAAK,GAAG,GAAG,EAAE,OAAO;UAAEa,CAAC,EAAEX,GAAG,CAACF,KAAK;UAAEc,CAAC,EAAEX,UAAU,CAACH,KAAK;UAAEe,CAAC,EAAEX,UAAU,CAACJ;QAAM,CAAC;QACxF,OAAO;UAAEa,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE;QAAG,CAAC;MAC9B;MACA,OAAO;QAAEF,CAAC,EAAEX,GAAG,CAACF,KAAK;QAAEc,CAAC,EAAEX,UAAU,CAACH,KAAK;QAAEe,CAAC,EAAEX,UAAU,CAACJ;MAAM,CAAC;IACnE;IAEA,IAAIT,OAAO,KAAK,GAAG,EAAE,OAAO;MAAEsB,CAAC,EAAEX,GAAG,CAACF,KAAK;MAAEc,CAAC,EAAE,GAAG;MAAEC,CAAC,EAAE;IAAI,CAAC;IAC5D,IAAIxB,OAAO,KAAK,GAAG,EAAE,OAAO;MAAEsB,CAAC,EAAEX,GAAG,CAACF,KAAK;MAAEc,CAAC,EAAE,GAAG;MAAEC,CAAC,EAAEX,UAAU,CAACJ;IAAM,CAAC;IACzE,IAAIT,OAAO,KAAK,GAAG,EAAE,OAAO;MAAEsB,CAAC,EAAEX,GAAG,CAACF,KAAK;MAAEc,CAAC,EAAEX,UAAU,CAACH,KAAK;MAAEe,CAAC,EAAE;IAAG,CAAC;IACxE,IAAIxB,OAAO,KAAK,GAAG,EAAE,OAAO;MAAEsB,CAAC,EAAEX,GAAG,CAACF,KAAK;MAAEc,CAAC,EAAET,KAAK,CAACL,KAAK,GAAG,GAAG;MAAEe,CAAC,EAAE;IAAG,CAAC;IACzE,OAAO;MAAEF,CAAC,EAAEX,GAAG,CAACF,KAAK;MAAEc,CAAC,EAAEX,UAAU,CAACH,KAAK;MAAEe,CAAC,EAAEX,UAAU,CAACJ;IAAM,CAAC;EACnE,CAAC;;EAED;EACA,IAAAgB,sCAAe,EAAC,MAAM;IACpBX,KAAK,CAACL,KAAK,CAAC,CAAC;IACbM,WAAW,CAACN,KAAK,GAAGiB,cAAQ,CAACC,OAAO,CAAC,CAAC,CAACC,GAAG,CAAC;MAAEN,CAAC,EAAEX,GAAG,CAACF,KAAK;MAAEc,CAAC,EAAEX,UAAU,CAACH,KAAK;MAAEe,CAAC,EAAEX,UAAU,CAACJ;IAAM,CAAC,CAAC;;IAEtG;IACA,MAAMoB,aAAa,GAAGR,wBAAwB,CAAC,CAAC;IAChD,MAAMS,aAAa,GAAGV,aAAa,CAACX,KAAK,KAAK,SAAS,GAAG;MAAEa,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAE,CAAC,GAAG;MAAEF,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAI,CAAC;IACvG,MAAMO,QAAQ,GAAGL,cAAQ,CAACC,OAAO,CAAC,CAAC,CAACK,aAAa,CAACH,aAAa,EAAEC,aAAa,CAAC;IAC/E,MAAMG,aAAa,GAAGb,aAAa,CAACX,KAAK,KAAK,SAAS,GAAG,SAAS,GAAG,SAAS;IAC/EW,aAAa,CAACX,KAAK,GAAGsB,QAAQ,GAAG,GAAG,GAAGE,aAAa,GAAGb,aAAa,CAACX,KAAK;EAC5E,CAAC,EAAE,CAACK,KAAK,EAAEH,GAAG,EAAEC,UAAU,EAAEC,UAAU,CAAC,CAAC;EAExC,MAAMqB,UAA8B,GAAG;IACrChC,KAAK;IACLC,MAAM;IACNC,YAAY;IACZN,QAAQ;IACRmB,UAAU;IACVG,aAAa;IACb9B,WAAW;IACXC,UAAU;IACVC,KAAK;IACLC;EACF,CAAC;;EAED;EACA,IAAIE,WAAW,EACb,oBACEjB,MAAA,CAAAU,OAAA,CAAA+C,aAAA,CAACxC,WAAW;IACVyC,aAAa,EAAE,CAACC,cAAM,CAACC,MAAM,EAAEhD,WAAW,CAAE;IAC5CY,KAAK,EAAEA,KAAM;IACbC,MAAM,EAAEA,MAAO;IACfoC,YAAY,EAAE9B,KAAM;IACpB+B,YAAY,EAAEzB,WAAY;IAC1BK,aAAa,EAAEA;EAAc,CAC9B,CAAC;;EAGN;EACA,MAAMqB,WAAW,GAAI7C,UAAU,CAAC8C,WAAW,CAAC,CAAC,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAGhD,UAAU,CAACiD,KAAK,CAAC,CAAC,CAAgC;EAE1H,IAAIJ,WAAW,IAAIK,eAAa,EAAE;IAChC,MAAMC,aAAa,GAAGD,eAAa,CAACL,WAAW,CAAC;IAChD,oBAAO/D,MAAA,CAAAU,OAAA,CAAA+C,aAAA,CAACY,aAAa,EAAKb,UAAa,CAAC;EAC1C;;EAEA;EACA,oBAAOxD,MAAA,CAAAU,OAAA,CAAA+C,aAAA,CAAClD,OAAA,CAAAG,OAAa,CAAC4D,IAAI,EAAKd,UAAa,CAAC;AAC/C"}