{"version":3,"file":"Preview.js","names":["_react","_interopRequireWildcard","require","_reactNative","_reactNativeReanimated","_index","_interopRequireDefault","_AppContext","_styles","_utils","_PreviewText","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","Preview","style","textStyle","colorFormat","hideInitialColor","hideText","disableOpacityTexture","hueValue","saturationValue","brightnessValue","alphaValue","returnedResults","value","usePickerContext","justifyContent","getStyle","initialColorText","useMemo","adaptiveTextColor","h","s","v","contrast","colorKit","contrastRatio","color","formatted","textColor","useSharedValue","textColorStyle","useAnimatedStyle","previewColor","previewColorStyle","backgroundColor","useDerivedValue","currentColor","runOnUI","HEX","compareColor1","compareColor2","reversedColor","createElement","Wrapper","disableTexture","ConditionalRendering","if","View","styles","previewContainer","Text","previewText","PreviewText","children","previewWrapper","isWeb","previewWrapperWebStyle","ImageBackground","source","imageStyle","width","height","resizeMode","backgroundImage","backgroundPosition","backgroundSize"],"sources":["../../src/components/Preview.tsx"],"sourcesContent":["import React, { useMemo } from 'react';\nimport { ImageBackground, Text, View } from 'react-native';\nimport Animated, { useAnimatedStyle, useDerivedValue, useSharedValue } from 'react-native-reanimated';\n\nimport colorKit from '../colorKit/index';\nimport usePickerContext from '../AppContext';\nimport { styles } from '../styles';\nimport { ConditionalRendering, getStyle, isWeb } from '../utils';\nimport { PreviewText } from './PreviewText';\n\nimport type { PreviewProps } from '../types';\nimport type { ReactNode } from 'react';\nimport type { StyleProp, ViewStyle } from 'react-native';\n\nexport function Preview({\n  style = {},\n  textStyle = {},\n  colorFormat = 'hex',\n  hideInitialColor = false,\n  hideText = false,\n  disableOpacityTexture = false,\n}: PreviewProps) {\n  const { hueValue, saturationValue, brightnessValue, alphaValue, returnedResults, value } = usePickerContext();\n\n  const justifyContent = getStyle(style, 'justifyContent') ?? 'center';\n\n  const initialColorText = useMemo(() => {\n    const adaptiveTextColor = alphaValue.value > 0.5 ? value : { h: 0, s: 0, v: 70 };\n    const contrast = colorKit.contrastRatio(adaptiveTextColor, '#ffffff');\n    const color = contrast < 4.5 ? '#000000' : '#ffffff';\n    return { formatted: returnedResults()[colorFormat], color };\n  }, [value, colorFormat]);\n\n  const textColor = useSharedValue<'#000000' | '#ffffff'>('#ffffff');\n  const textColorStyle = useAnimatedStyle(() => ({ color: textColor.value }), [textColor]);\n\n  const previewColor = useSharedValue('#ffffff');\n  const previewColorStyle = useAnimatedStyle(() => ({ backgroundColor: previewColor.value }), [previewColor]);\n\n  // When the values of channels change\n  useDerivedValue(() => {\n    const currentColor = { h: hueValue.value, s: saturationValue.value, v: brightnessValue.value, a: alphaValue.value };\n\n    previewColor.value = colorKit\n      .runOnUI()\n      .HEX({ h: hueValue.value, s: saturationValue.value, v: brightnessValue.value, a: alphaValue.value });\n\n    // calculate the contrast ratio\n    const compareColor1 = alphaValue.value > 0.5 ? currentColor : { h: 0, s: 0, v: 70 };\n    const compareColor2 = textColor.value === '#000000' ? { h: 0, s: 0, v: 0 } : { h: 0, s: 0, v: 100 };\n    const contrast = colorKit.runOnUI().contrastRatio(compareColor1, compareColor2);\n    const reversedColor = textColor.value === '#ffffff' ? '#000000' : '#ffffff';\n    textColor.value = contrast < 4.5 ? reversedColor : textColor.value;\n  }, [hueValue, saturationValue, brightnessValue, alphaValue]);\n\n  return (\n    <Wrapper disableTexture={disableOpacityTexture} style={style}>\n      <ConditionalRendering if={!hideInitialColor}>\n        <View style={[styles.previewContainer, { backgroundColor: value, justifyContent }]}>\n          <ConditionalRendering if={!hideText}>\n            <Text style={[styles.previewText, { color: initialColorText.color }, textStyle]}>{initialColorText.formatted}</Text>\n          </ConditionalRendering>\n        </View>\n      </ConditionalRendering>\n\n      <Animated.View style={[styles.previewContainer, { justifyContent }, previewColorStyle]}>\n        <ConditionalRendering if={!hideText}>\n          <PreviewText colorFormat={colorFormat} style={[textStyle, textColorStyle]} />\n        </ConditionalRendering>\n      </Animated.View>\n    </Wrapper>\n  );\n}\n\ntype WrapperProps = {\n  children: ReactNode;\n  disableTexture: boolean;\n  style: StyleProp<ViewStyle>;\n};\n\nfunction Wrapper({ children, disableTexture, style }: WrapperProps) {\n  if (disableTexture) {\n    return <View style={[styles.previewWrapper, style]}>{children}</View>;\n  }\n\n  if (isWeb) {\n    return <View style={[styles.previewWrapper, previewWrapperWebStyle, style]}>{children}</View>;\n  }\n\n  return (\n    <ImageBackground\n      source={require('../assets/transparent-texture.png')}\n      imageStyle={{ width: '100%', height: '100%' }}\n      resizeMode='repeat'\n      style={[styles.previewWrapper, style]}\n    >\n      {children}\n    </ImageBackground>\n  );\n}\n\nconst previewWrapperWebStyle = {\n  backgroundImage:\n    'repeating-linear-gradient(45deg, #c1c1c1 25%, transparent 25%, transparent 75%, #c1c1c1 75%, #c1c1c1), repeating-linear-gradient(45deg, #c1c1c1 25%, #fff 25%, #fff 75%, #c1c1c1 75%, #c1c1c1)',\n  backgroundPosition: '0px 0px, 8px 8px',\n  backgroundSize: '16px 16px',\n} as StyleProp<ViewStyle>;\n"],"mappings":"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"}