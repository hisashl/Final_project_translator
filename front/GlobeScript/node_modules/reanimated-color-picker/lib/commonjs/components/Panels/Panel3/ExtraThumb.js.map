{"version":3,"file":"ExtraThumb.js","names":["_react","_interopRequireDefault","require","_reactNativeReanimated","_interopRequireWildcard","_AppContext","_styles","_Thumb","_utils","_Panel3Context","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","obj","ExtraThumb","onChange","colorTransform","hueTransform","saturationTransform","brightnessTransform","renderThumb","props","width","boundedThumb","centerChannel","centerChannelValue","adaptSpectrum","rotate","ctx","usePanel3Context","hueValue","saturationValue","brightnessValue","alphaValue","returnedResults","usePickerContext","thumbSize","thumbShape","thumbColor","thumbStyle","thumbInnerStyle","renderCenterLine","hsv","useDerivedValue","currentColor","h","value","s","v","transformedColor","hue","changeAmount","parseFloat","clamp","saturation","brightness","colors","error","runOnJS","handleStyle","useAnimatedStyle","center","rotatedHue","distance","angle","Math","PI","posY","sin","posX","cos","transform","translateX","translateY","centerLineStyle","lineThickness","top","left","height","createElement","Fragment","ConditionalRendering","if","View","style","styles","panel3Line","channel","innerStyle","overrideHSV"],"sources":["../../../../src/components/Panels/Panel3/ExtraThumb.tsx"],"sourcesContent":["import React from 'react';\nimport Animated, { runOnJS, useAnimatedStyle, useDerivedValue } from 'react-native-reanimated';\n\nimport usePickerContext from '../../../AppContext';\nimport { styles } from '../../../styles';\nimport Thumb from '../../Thumb/Thumb';\nimport { ConditionalRendering, clamp } from '../../../utils';\nimport usePanel3Context from './Panel3Context';\n\nimport type { ExtraThumbProps } from '../../../types';\n\nexport function ExtraThumb({\n  onChange,\n  colorTransform,\n  hueTransform,\n  saturationTransform,\n  brightnessTransform,\n  renderThumb,\n  ...props\n}: ExtraThumbProps) {\n  const { width, boundedThumb, centerChannel, centerChannelValue, adaptSpectrum, rotate, ...ctx } = usePanel3Context();\n  const { hueValue, saturationValue, brightnessValue, alphaValue, returnedResults } = usePickerContext();\n\n  const thumbSize = props.thumbSize ?? ctx.thumbSize,\n    thumbShape = props.thumbShape ?? ctx.thumbShape,\n    thumbColor = props.thumbColor ?? ctx.thumbColor,\n    thumbStyle = props.thumbStyle ?? ctx.thumbStyle,\n    thumbInnerStyle = props.thumbInnerStyle ?? ctx.thumbInnerStyle,\n    renderCenterLine = props.renderCenterLine ?? ctx.renderCenterLine;\n\n  // Calculate color\n  const hsv = useDerivedValue(() => {\n    const currentColor = { h: hueValue.value, s: saturationValue.value, v: brightnessValue.value, a: alphaValue.value };\n    if (!colorTransform) return currentColor;\n    const transformedColor = colorTransform(currentColor);\n\n    return transformedColor;\n  }, [hueValue, saturationValue, brightnessValue, alphaValue]);\n\n  // Calculate hue value\n  const hue = useDerivedValue(() => {\n    if (colorTransform) return hsv.value.h;\n\n    if (!hueTransform) return hueValue.value;\n\n    const changeAmount = typeof hueTransform === 'string' ? hueValue.value * (parseFloat(hueTransform) / 100) : hueTransform;\n\n    return clamp((hueValue.value + changeAmount) % 360, 360);\n  }, [hsv, hueValue]);\n\n  // Calculate saturation value\n  const saturation = useDerivedValue(() => {\n    if (colorTransform) return hsv.value.s;\n\n    if (!saturationTransform) return saturationValue.value;\n\n    const changeAmount =\n      typeof saturationTransform === 'string'\n        ? saturationValue.value * (parseFloat(saturationTransform) / 100)\n        : saturationTransform;\n\n    return clamp(saturationValue.value + changeAmount, 100);\n  }, [hsv, saturationValue]);\n\n  // Calculate brightness value\n  const brightness = useDerivedValue(() => {\n    if (colorTransform) return hsv.value.v;\n\n    if (!brightnessTransform) return brightnessValue.value;\n\n    const changeAmount =\n      typeof brightnessTransform === 'string'\n        ? brightnessValue.value * (parseFloat(brightnessTransform) / 100)\n        : brightnessTransform;\n\n    return clamp(brightnessValue.value + changeAmount, 100);\n  }, [hsv, brightnessValue]);\n\n  // Call onChange prop on every value change\n  useDerivedValue(() => {\n    if (!onChange) return;\n\n    const colors = returnedResults({\n      h: hue.value,\n      s: saturation.value,\n      v: brightness.value,\n      a: alphaValue.value,\n    });\n\n    try {\n      onChange(colors);\n    } catch (error) {\n      runOnJS(onChange)(colors);\n    }\n  }, [hue, saturation, brightness]);\n\n  const handleStyle = useAnimatedStyle(() => {\n    const center = width.value / 2 - (boundedThumb ? thumbSize / 2 : 0),\n      rotatedHue = (hue.value - rotate) % 360,\n      distance = (centerChannelValue.value / 100) * (width.value / 2 - (boundedThumb ? thumbSize / 2 : 0)),\n      angle = (rotatedHue * Math.PI) / 180,\n      posY = width.value - (Math.sin(angle) * distance + center) - (boundedThumb ? thumbSize : thumbSize / 2),\n      posX = width.value - (Math.cos(angle) * distance + center) - (boundedThumb ? thumbSize : thumbSize / 2);\n\n    return {\n      transform: [{ translateX: posX }, { translateY: posY }, { rotate: rotatedHue + 90 + 'deg' }],\n    };\n  }, [thumbSize, boundedThumb, width, centerChannelValue, hue]);\n\n  const centerLineStyle = useAnimatedStyle(() => {\n    if (!renderCenterLine) return {};\n\n    const lineThickness = 1,\n      center = width.value / 2 - (boundedThumb ? thumbSize / 2 : 0),\n      rotatedHue = (hue.value - rotate) % 360,\n      distance = (centerChannelValue.value / 100) * center,\n      angle = ((rotatedHue * Math.PI) / Math.PI + 180) % 360; // reversed angle\n\n    return {\n      top: (width.value - lineThickness) / 2,\n      left: (width.value - distance) / 2,\n      height: lineThickness,\n      width: distance,\n      transform: [{ rotate: angle + 'deg' }, { translateX: distance / 2 }, { translateY: 0 }],\n    };\n  }, [renderCenterLine, boundedThumb, thumbSize, width, hue, centerChannelValue]);\n\n  return (\n    <>\n      <ConditionalRendering if={renderCenterLine}>\n        <Animated.View style={[styles.panel3Line, centerLineStyle]} />\n      </ConditionalRendering>\n\n      <Thumb\n        channel={centerChannel === 'brightness' ? 'v' : 's'}\n        thumbShape={thumbShape}\n        thumbSize={thumbSize}\n        thumbColor={thumbColor}\n        renderThumb={renderThumb}\n        innerStyle={thumbInnerStyle}\n        handleStyle={handleStyle}\n        style={thumbStyle}\n        adaptSpectrum={adaptSpectrum}\n        overrideHSV={{ hue, saturation, brightness }}\n      />\n    </>\n  );\n}\n"],"mappings":"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"}