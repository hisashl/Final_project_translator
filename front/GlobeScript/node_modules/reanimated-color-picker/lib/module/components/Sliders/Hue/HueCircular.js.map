{"version":3,"file":"HueCircular.js","names":["React","useCallback","ImageBackground","StyleSheet","Gesture","GestureDetector","Animated","useAnimatedStyle","useSharedValue","withTiming","usePickerContext","styles","Thumb","ConditionalRendering","HSVA2HSLA_string","HueCircular","children","gestures","style","containerStyle","rotate","props","hueValue","saturationValue","brightnessValue","onGestureChange","onGestureEnd","ctx","thumbShape","thumbSize","thumbColor","renderThumb","thumbStyle","sliderThickness","thumbScaleAnimationValue","thumbScaleAnimationDuration","adaptSpectrum","thumbInnerStyle","isGestureActive","width","borderRadius","borderRadiusStyle","value","handleScale","handleStyle","center","rotatedHue","distance","angle","Math","PI","posY","sin","posX","cos","transform","translateX","translateY","scale","activeSaturationStyle","backgroundColor","activeBrightnessStyle","clipViewStyle","position","height","onGestureUpdate","x","y","dx","dy","theta","atan2","newHueValue","onGestureBegin","event","R","clickR","sqrt","innerR","duration","onGestureFinish","pan","Pan","onBegin","onUpdate","onEnd","tap","Tap","longPress","LongPress","composed","Simultaneous","Exclusive","onLayout","nativeEvent","layout","layoutWidth","createElement","gesture","View","panel_container","justifyContent","alignItems","aspectRatio","borderWidth","padding","source","require","panel_image","resizeMode","if","absoluteFillObject","channel","innerStyle"],"sources":["../../../../src/components/Sliders/Hue/HueCircular.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { ImageBackground, StyleSheet } from 'react-native';\nimport { Gesture, GestureDetector } from 'react-native-gesture-handler';\nimport Animated, { useAnimatedStyle, useSharedValue, withTiming } from 'react-native-reanimated';\n\nimport usePickerContext from '../../../AppContext';\nimport { styles } from '../../../styles';\nimport Thumb from '../../Thumb/Thumb';\nimport { ConditionalRendering, HSVA2HSLA_string } from '../../../utils';\n\nimport type { HueCircularProps } from '../../../types';\nimport type { LayoutChangeEvent } from 'react-native';\nimport type { PanGestureHandlerEventPayload } from 'react-native-gesture-handler';\n\nexport function HueCircular({\n  children,\n  gestures = [],\n  style = {},\n  containerStyle = {},\n  rotate = 0,\n  ...props\n}: HueCircularProps) {\n  const { hueValue, saturationValue, brightnessValue, onGestureChange, onGestureEnd, ...ctx } = usePickerContext();\n\n  const thumbShape = props.thumbShape ?? ctx.thumbShape,\n    thumbSize = props.thumbSize ?? ctx.thumbSize,\n    thumbColor = props.thumbColor ?? ctx.thumbColor,\n    renderThumb = props.renderThumb ?? ctx.renderThumb,\n    thumbStyle = props.thumbStyle ?? ctx.thumbStyle ?? {},\n    sliderThickness = props.sliderThickness ?? ctx.sliderThickness,\n    thumbScaleAnimationValue = props.thumbScaleAnimationValue ?? ctx.thumbScaleAnimationValue,\n    thumbScaleAnimationDuration = props.thumbScaleAnimationDuration ?? ctx.thumbScaleAnimationDuration,\n    adaptSpectrum = props.adaptSpectrum ?? ctx.adaptSpectrum,\n    thumbInnerStyle = props.thumbInnerStyle ?? ctx.thumbInnerStyle ?? {};\n\n  const isGestureActive = useSharedValue(false);\n  const width = useSharedValue(0);\n  const borderRadius = useSharedValue(0);\n  const borderRadiusStyle = useAnimatedStyle(() => ({ borderRadius: borderRadius.value }), [borderRadius]);\n\n  const handleScale = useSharedValue(1);\n\n  const handleStyle = useAnimatedStyle(() => {\n    const center = width.value / 2,\n      rotatedHue = (hueValue.value - rotate) % 360,\n      distance = (width.value - sliderThickness) / 2,\n      angle = (rotatedHue * Math.PI) / 180,\n      posY = width.value - (Math.sin(angle) * distance + center) - thumbSize / 2,\n      posX = width.value - (Math.cos(angle) * distance + center) - thumbSize / 2;\n\n    return {\n      transform: [{ translateX: posX }, { translateY: posY }, { scale: handleScale.value }, { rotate: rotatedHue + 90 + 'deg' }],\n    };\n  }, [width, hueValue, handleScale]);\n\n  const activeSaturationStyle = useAnimatedStyle(() => {\n    if (!adaptSpectrum) return {};\n\n    return { backgroundColor: HSVA2HSLA_string(0, 0, brightnessValue.value, 1 - saturationValue.value / 100) };\n  }, [brightnessValue, saturationValue]);\n\n  const activeBrightnessStyle = useAnimatedStyle(() => {\n    if (!adaptSpectrum) return {};\n\n    return { backgroundColor: HSVA2HSLA_string(0, 0, 0, 1 - brightnessValue.value / 100) };\n  }, [brightnessValue]);\n\n  const clipViewStyle = useAnimatedStyle(() => {\n    return {\n      position: 'absolute',\n      width: width.value - sliderThickness * 2,\n      height: width.value - sliderThickness * 2,\n      borderRadius: width.value / 2,\n    };\n  }, [width]);\n\n  const onGestureUpdate = ({ x, y }: PanGestureHandlerEventPayload) => {\n    'worklet';\n\n    if (!isGestureActive.value) return;\n\n    const center = width.value / 2,\n      dx = center - x,\n      dy = center - y,\n      theta = Math.atan2(dy, dx) * (180 / Math.PI), // [0 - 180] range\n      angle = theta < 0 ? 360 + theta : theta, // [0 - 360] range\n      newHueValue = (angle + rotate) % 360;\n\n    if (hueValue.value === newHueValue) return;\n\n    hueValue.value = newHueValue;\n\n    onGestureChange();\n  };\n\n  const onGestureBegin = (event: PanGestureHandlerEventPayload) => {\n    'worklet';\n\n    const R = width.value / 2,\n      dx = R - event.x,\n      dy = R - event.y,\n      clickR = Math.sqrt(dx * dx + dy * dy);\n\n    // Check if the press is outside the circle\n    if (clickR > R) {\n      isGestureActive.value = false;\n      return;\n    }\n\n    // check if the press inside the circle (not on the actual slider)\n    const innerR = width.value / 2 - sliderThickness;\n    if (clickR < innerR) {\n      isGestureActive.value = false;\n      return;\n    }\n\n    isGestureActive.value = true;\n    handleScale.value = withTiming(thumbScaleAnimationValue, { duration: thumbScaleAnimationDuration });\n    onGestureUpdate(event);\n  };\n\n  const onGestureFinish = () => {\n    'worklet';\n    isGestureActive.value = false;\n    handleScale.value = withTiming(1, { duration: thumbScaleAnimationDuration });\n    onGestureEnd();\n  };\n\n  const pan = Gesture.Pan().onBegin(onGestureBegin).onUpdate(onGestureUpdate).onEnd(onGestureFinish);\n  const tap = Gesture.Tap().onEnd(onGestureFinish);\n  const longPress = Gesture.LongPress().onEnd(onGestureFinish);\n  const composed = Gesture.Simultaneous(Gesture.Exclusive(pan, tap, longPress), ...gestures);\n\n  const onLayout = useCallback(({ nativeEvent: { layout } }: LayoutChangeEvent) => {\n    const layoutWidth = layout.width;\n    width.value = layoutWidth;\n    borderRadius.value = withTiming(layoutWidth / 2, { duration: 5 });\n  }, []);\n\n  return (\n    <GestureDetector gesture={composed}>\n      <Animated.View\n        onLayout={onLayout}\n        style={[\n          styles.panel_container,\n          { justifyContent: 'center', alignItems: 'center' },\n          style,\n          { position: 'relative', aspectRatio: 1, borderWidth: 0, padding: 0 },\n          borderRadiusStyle,\n        ]}\n      >\n        <ImageBackground\n          source={require('../../../assets/circularHue.png')}\n          style={[styles.panel_image, { transform: [{ rotate: -rotate + 'deg' }] }]}\n          resizeMode='stretch'\n        >\n          <ConditionalRendering if={adaptSpectrum}>\n            <Animated.View style={[borderRadiusStyle, activeBrightnessStyle, StyleSheet.absoluteFillObject]} />\n            <Animated.View style={[borderRadiusStyle, activeSaturationStyle, StyleSheet.absoluteFillObject]} />\n          </ConditionalRendering>\n        </ImageBackground>\n\n        <Animated.View style={[clipViewStyle, { backgroundColor: '#fff' }, containerStyle]}>{children}</Animated.View>\n\n        <Thumb\n          channel='h'\n          thumbShape={thumbShape}\n          thumbSize={thumbSize}\n          thumbColor={thumbColor}\n          renderThumb={renderThumb}\n          innerStyle={thumbInnerStyle}\n          handleStyle={handleStyle}\n          style={thumbStyle}\n          adaptSpectrum={adaptSpectrum}\n        />\n      </Animated.View>\n    </GestureDetector>\n  );\n}\n"],"mappings":"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"}