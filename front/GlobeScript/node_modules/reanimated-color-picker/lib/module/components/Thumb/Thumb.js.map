{"version":3,"file":"Thumb.js","names":["React","useAnimatedStyle","useDerivedValue","useSharedValue","colorKit","usePickerContext","styles","BuiltinThumbs","Thumb","handleStyle","innerStyle","style","thumbColor","renderThumb","RenderThumb","thumbShape","thumbSize","vertical","adaptSpectrum","channel","overrideHSV","width","height","borderRadius","hueValue","saturationValue","brightnessValue","alphaValue","value","hue","saturation","brightness","alpha","resultColor","solidColor","backgroundColor","adaptiveColor","getColorForAdaptiveColor","h","s","v","runOnUI","HEX","compareColor1","compareColor2","contrast","contrastRatio","reversedColor","thumbProps","createElement","positionStyle","handle","initialColor","currentColor","thumb_Shape","toLowerCase","charAt","toUpperCase","slice","SelectedThumb","Ring"],"sources":["../../../src/components/Thumb/Thumb.tsx"],"sourcesContent":["import React from 'react';\nimport { useAnimatedStyle, useDerivedValue, useSharedValue } from 'react-native-reanimated';\n\nimport colorKit from '../../colorKit/index';\nimport usePickerContext from '../../AppContext';\nimport { styles } from '../../styles';\nimport BuiltinThumbs from './BuiltinThumbs/index';\n\nimport type { BuiltinThumbsProps, ThumbProps } from '../../types';\n\nexport default function Thumb({\n  handleStyle,\n  innerStyle,\n  style,\n  thumbColor,\n  renderThumb: RenderThumb,\n  thumbShape = 'ring',\n  thumbSize,\n  vertical = false,\n  adaptSpectrum,\n  channel,\n  overrideHSV,\n}: ThumbProps) {\n  const { width, height, borderRadius } = { width: thumbSize, height: thumbSize, borderRadius: thumbSize / 2 };\n  const { hueValue, saturationValue, brightnessValue, alphaValue, value } = usePickerContext();\n\n  const hue = overrideHSV?.hue ?? hueValue,\n    saturation = overrideHSV?.saturation ?? saturationValue,\n    brightness = overrideHSV?.brightness ?? brightnessValue,\n    alpha = overrideHSV?.alpha ?? alphaValue;\n\n  const resultColor = useSharedValue('#ffffff');\n  const solidColor = useAnimatedStyle(() => ({ backgroundColor: thumbColor ?? resultColor.value }), [resultColor]);\n  const adaptiveColor = useSharedValue<'#000000' | '#ffffff'>('#ffffff');\n\n  /**\n   * Get the current color and calculate its contrast ratio against white or black, depending on the channel and whether\n   * 'adaptSpectrum' is enabled\n   */\n  const getColorForAdaptiveColor = () => {\n    'worklet';\n    if (adaptSpectrum) {\n      if (channel === 'a') {\n        if (alpha.value > 0.5) return { h: hue.value, s: saturation.value, v: brightness.value };\n        return { h: 0, s: 0, v: 70 };\n      }\n      return { h: hue.value, s: saturation.value, v: brightness.value };\n    }\n\n    if (channel === 'h') return { h: hue.value, s: 100, v: 100 };\n    if (channel === 'v') return { h: hue.value, s: 100, v: brightness.value };\n    if (channel === 's') return { h: hue.value, s: saturation.value, v: 70 };\n    if (channel === 'a') return { h: hue.value, s: alpha.value * 100, v: 70 };\n    return { h: hue.value, s: saturation.value, v: brightness.value };\n  };\n\n  // When the values of channels change\n  useDerivedValue(() => {\n    alpha.value; // to track alpha changes too;\n    resultColor.value = colorKit.runOnUI().HEX({ h: hue.value, s: saturation.value, v: brightness.value });\n\n    // calculate the contrast ratio\n    const compareColor1 = getColorForAdaptiveColor();\n    const compareColor2 = adaptiveColor.value === '#000000' ? { h: 0, s: 0, v: 0 } : { h: 0, s: 0, v: 100 };\n    const contrast = colorKit.runOnUI().contrastRatio(compareColor1, compareColor2);\n    const reversedColor = adaptiveColor.value === '#ffffff' ? '#000000' : '#ffffff';\n    adaptiveColor.value = contrast < 4.5 ? reversedColor : adaptiveColor.value;\n  }, [alpha, hue, saturation, brightness]);\n\n  const thumbProps: BuiltinThumbsProps = {\n    width,\n    height,\n    borderRadius,\n    vertical,\n    solidColor,\n    adaptiveColor,\n    handleStyle,\n    innerStyle,\n    style,\n    thumbColor,\n  };\n\n  // render a custom thumb\n  if (RenderThumb)\n    return (\n      <RenderThumb\n        positionStyle={[styles.handle, handleStyle]}\n        width={width}\n        height={height}\n        initialColor={value}\n        currentColor={resultColor}\n        adaptiveColor={adaptiveColor}\n      />\n    );\n\n  // normalize 'thumbShape' string to match 'BuiltinThumbs' keys.\n  const thumb_Shape = (thumbShape.toLowerCase().charAt(0).toUpperCase() + thumbShape.slice(1)) as keyof typeof BuiltinThumbs;\n\n  if (thumb_Shape in BuiltinThumbs) {\n    const SelectedThumb = BuiltinThumbs[thumb_Shape];\n    return <SelectedThumb {...thumbProps} />;\n  }\n\n  // default to the 'Ring' thumb\n  return <BuiltinThumbs.Ring {...thumbProps} />;\n}\n"],"mappings":"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"}