{"version":3,"file":"ExtraThumb.js","names":["React","Animated","runOnJS","useAnimatedStyle","useDerivedValue","usePickerContext","styles","Thumb","ConditionalRendering","clamp","usePanel3Context","ExtraThumb","onChange","colorTransform","hueTransform","saturationTransform","brightnessTransform","renderThumb","props","width","boundedThumb","centerChannel","centerChannelValue","adaptSpectrum","rotate","ctx","hueValue","saturationValue","brightnessValue","alphaValue","returnedResults","thumbSize","thumbShape","thumbColor","thumbStyle","thumbInnerStyle","renderCenterLine","hsv","currentColor","h","value","s","v","a","transformedColor","hue","changeAmount","parseFloat","saturation","brightness","colors","error","handleStyle","center","rotatedHue","distance","angle","Math","PI","posY","sin","posX","cos","transform","translateX","translateY","centerLineStyle","lineThickness","top","left","height","createElement","Fragment","if","View","style","panel3Line","channel","innerStyle","overrideHSV"],"sources":["../../../../src/components/Panels/Panel3/ExtraThumb.tsx"],"sourcesContent":["import React from 'react';\nimport Animated, { runOnJS, useAnimatedStyle, useDerivedValue } from 'react-native-reanimated';\n\nimport usePickerContext from '../../../AppContext';\nimport { styles } from '../../../styles';\nimport Thumb from '../../Thumb/Thumb';\nimport { ConditionalRendering, clamp } from '../../../utils';\nimport usePanel3Context from './Panel3Context';\n\nimport type { ExtraThumbProps } from '../../../types';\n\nexport function ExtraThumb({\n  onChange,\n  colorTransform,\n  hueTransform,\n  saturationTransform,\n  brightnessTransform,\n  renderThumb,\n  ...props\n}: ExtraThumbProps) {\n  const { width, boundedThumb, centerChannel, centerChannelValue, adaptSpectrum, rotate, ...ctx } = usePanel3Context();\n  const { hueValue, saturationValue, brightnessValue, alphaValue, returnedResults } = usePickerContext();\n\n  const thumbSize = props.thumbSize ?? ctx.thumbSize,\n    thumbShape = props.thumbShape ?? ctx.thumbShape,\n    thumbColor = props.thumbColor ?? ctx.thumbColor,\n    thumbStyle = props.thumbStyle ?? ctx.thumbStyle,\n    thumbInnerStyle = props.thumbInnerStyle ?? ctx.thumbInnerStyle,\n    renderCenterLine = props.renderCenterLine ?? ctx.renderCenterLine;\n\n  // Calculate color\n  const hsv = useDerivedValue(() => {\n    const currentColor = { h: hueValue.value, s: saturationValue.value, v: brightnessValue.value, a: alphaValue.value };\n    if (!colorTransform) return currentColor;\n    const transformedColor = colorTransform(currentColor);\n\n    return transformedColor;\n  }, [hueValue, saturationValue, brightnessValue, alphaValue]);\n\n  // Calculate hue value\n  const hue = useDerivedValue(() => {\n    if (colorTransform) return hsv.value.h;\n\n    if (!hueTransform) return hueValue.value;\n\n    const changeAmount = typeof hueTransform === 'string' ? hueValue.value * (parseFloat(hueTransform) / 100) : hueTransform;\n\n    return clamp((hueValue.value + changeAmount) % 360, 360);\n  }, [hsv, hueValue]);\n\n  // Calculate saturation value\n  const saturation = useDerivedValue(() => {\n    if (colorTransform) return hsv.value.s;\n\n    if (!saturationTransform) return saturationValue.value;\n\n    const changeAmount =\n      typeof saturationTransform === 'string'\n        ? saturationValue.value * (parseFloat(saturationTransform) / 100)\n        : saturationTransform;\n\n    return clamp(saturationValue.value + changeAmount, 100);\n  }, [hsv, saturationValue]);\n\n  // Calculate brightness value\n  const brightness = useDerivedValue(() => {\n    if (colorTransform) return hsv.value.v;\n\n    if (!brightnessTransform) return brightnessValue.value;\n\n    const changeAmount =\n      typeof brightnessTransform === 'string'\n        ? brightnessValue.value * (parseFloat(brightnessTransform) / 100)\n        : brightnessTransform;\n\n    return clamp(brightnessValue.value + changeAmount, 100);\n  }, [hsv, brightnessValue]);\n\n  // Call onChange prop on every value change\n  useDerivedValue(() => {\n    if (!onChange) return;\n\n    const colors = returnedResults({\n      h: hue.value,\n      s: saturation.value,\n      v: brightness.value,\n      a: alphaValue.value,\n    });\n\n    try {\n      onChange(colors);\n    } catch (error) {\n      runOnJS(onChange)(colors);\n    }\n  }, [hue, saturation, brightness]);\n\n  const handleStyle = useAnimatedStyle(() => {\n    const center = width.value / 2 - (boundedThumb ? thumbSize / 2 : 0),\n      rotatedHue = (hue.value - rotate) % 360,\n      distance = (centerChannelValue.value / 100) * (width.value / 2 - (boundedThumb ? thumbSize / 2 : 0)),\n      angle = (rotatedHue * Math.PI) / 180,\n      posY = width.value - (Math.sin(angle) * distance + center) - (boundedThumb ? thumbSize : thumbSize / 2),\n      posX = width.value - (Math.cos(angle) * distance + center) - (boundedThumb ? thumbSize : thumbSize / 2);\n\n    return {\n      transform: [{ translateX: posX }, { translateY: posY }, { rotate: rotatedHue + 90 + 'deg' }],\n    };\n  }, [thumbSize, boundedThumb, width, centerChannelValue, hue]);\n\n  const centerLineStyle = useAnimatedStyle(() => {\n    if (!renderCenterLine) return {};\n\n    const lineThickness = 1,\n      center = width.value / 2 - (boundedThumb ? thumbSize / 2 : 0),\n      rotatedHue = (hue.value - rotate) % 360,\n      distance = (centerChannelValue.value / 100) * center,\n      angle = ((rotatedHue * Math.PI) / Math.PI + 180) % 360; // reversed angle\n\n    return {\n      top: (width.value - lineThickness) / 2,\n      left: (width.value - distance) / 2,\n      height: lineThickness,\n      width: distance,\n      transform: [{ rotate: angle + 'deg' }, { translateX: distance / 2 }, { translateY: 0 }],\n    };\n  }, [renderCenterLine, boundedThumb, thumbSize, width, hue, centerChannelValue]);\n\n  return (\n    <>\n      <ConditionalRendering if={renderCenterLine}>\n        <Animated.View style={[styles.panel3Line, centerLineStyle]} />\n      </ConditionalRendering>\n\n      <Thumb\n        channel={centerChannel === 'brightness' ? 'v' : 's'}\n        thumbShape={thumbShape}\n        thumbSize={thumbSize}\n        thumbColor={thumbColor}\n        renderThumb={renderThumb}\n        innerStyle={thumbInnerStyle}\n        handleStyle={handleStyle}\n        style={thumbStyle}\n        adaptSpectrum={adaptSpectrum}\n        overrideHSV={{ hue, saturation, brightness }}\n      />\n    </>\n  );\n}\n"],"mappings":"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"}