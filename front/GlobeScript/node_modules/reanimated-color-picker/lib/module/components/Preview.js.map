{"version":3,"file":"Preview.js","names":["React","useMemo","ImageBackground","Text","View","Animated","useAnimatedStyle","useDerivedValue","useSharedValue","colorKit","usePickerContext","styles","ConditionalRendering","getStyle","isWeb","PreviewText","Preview","style","textStyle","colorFormat","hideInitialColor","hideText","disableOpacityTexture","hueValue","saturationValue","brightnessValue","alphaValue","returnedResults","value","justifyContent","initialColorText","adaptiveTextColor","h","s","v","contrast","contrastRatio","color","formatted","textColor","textColorStyle","previewColor","previewColorStyle","backgroundColor","currentColor","a","runOnUI","HEX","compareColor1","compareColor2","reversedColor","createElement","Wrapper","disableTexture","if","previewContainer","previewText","children","previewWrapper","previewWrapperWebStyle","source","require","imageStyle","width","height","resizeMode","backgroundImage","backgroundPosition","backgroundSize"],"sources":["../../src/components/Preview.tsx"],"sourcesContent":["import React, { useMemo } from 'react';\nimport { ImageBackground, Text, View } from 'react-native';\nimport Animated, { useAnimatedStyle, useDerivedValue, useSharedValue } from 'react-native-reanimated';\n\nimport colorKit from '../colorKit/index';\nimport usePickerContext from '../AppContext';\nimport { styles } from '../styles';\nimport { ConditionalRendering, getStyle, isWeb } from '../utils';\nimport { PreviewText } from './PreviewText';\n\nimport type { PreviewProps } from '../types';\nimport type { ReactNode } from 'react';\nimport type { StyleProp, ViewStyle } from 'react-native';\n\nexport function Preview({\n  style = {},\n  textStyle = {},\n  colorFormat = 'hex',\n  hideInitialColor = false,\n  hideText = false,\n  disableOpacityTexture = false,\n}: PreviewProps) {\n  const { hueValue, saturationValue, brightnessValue, alphaValue, returnedResults, value } = usePickerContext();\n\n  const justifyContent = getStyle(style, 'justifyContent') ?? 'center';\n\n  const initialColorText = useMemo(() => {\n    const adaptiveTextColor = alphaValue.value > 0.5 ? value : { h: 0, s: 0, v: 70 };\n    const contrast = colorKit.contrastRatio(adaptiveTextColor, '#ffffff');\n    const color = contrast < 4.5 ? '#000000' : '#ffffff';\n    return { formatted: returnedResults()[colorFormat], color };\n  }, [value, colorFormat]);\n\n  const textColor = useSharedValue<'#000000' | '#ffffff'>('#ffffff');\n  const textColorStyle = useAnimatedStyle(() => ({ color: textColor.value }), [textColor]);\n\n  const previewColor = useSharedValue('#ffffff');\n  const previewColorStyle = useAnimatedStyle(() => ({ backgroundColor: previewColor.value }), [previewColor]);\n\n  // When the values of channels change\n  useDerivedValue(() => {\n    const currentColor = { h: hueValue.value, s: saturationValue.value, v: brightnessValue.value, a: alphaValue.value };\n\n    previewColor.value = colorKit\n      .runOnUI()\n      .HEX({ h: hueValue.value, s: saturationValue.value, v: brightnessValue.value, a: alphaValue.value });\n\n    // calculate the contrast ratio\n    const compareColor1 = alphaValue.value > 0.5 ? currentColor : { h: 0, s: 0, v: 70 };\n    const compareColor2 = textColor.value === '#000000' ? { h: 0, s: 0, v: 0 } : { h: 0, s: 0, v: 100 };\n    const contrast = colorKit.runOnUI().contrastRatio(compareColor1, compareColor2);\n    const reversedColor = textColor.value === '#ffffff' ? '#000000' : '#ffffff';\n    textColor.value = contrast < 4.5 ? reversedColor : textColor.value;\n  }, [hueValue, saturationValue, brightnessValue, alphaValue]);\n\n  return (\n    <Wrapper disableTexture={disableOpacityTexture} style={style}>\n      <ConditionalRendering if={!hideInitialColor}>\n        <View style={[styles.previewContainer, { backgroundColor: value, justifyContent }]}>\n          <ConditionalRendering if={!hideText}>\n            <Text style={[styles.previewText, { color: initialColorText.color }, textStyle]}>{initialColorText.formatted}</Text>\n          </ConditionalRendering>\n        </View>\n      </ConditionalRendering>\n\n      <Animated.View style={[styles.previewContainer, { justifyContent }, previewColorStyle]}>\n        <ConditionalRendering if={!hideText}>\n          <PreviewText colorFormat={colorFormat} style={[textStyle, textColorStyle]} />\n        </ConditionalRendering>\n      </Animated.View>\n    </Wrapper>\n  );\n}\n\ntype WrapperProps = {\n  children: ReactNode;\n  disableTexture: boolean;\n  style: StyleProp<ViewStyle>;\n};\n\nfunction Wrapper({ children, disableTexture, style }: WrapperProps) {\n  if (disableTexture) {\n    return <View style={[styles.previewWrapper, style]}>{children}</View>;\n  }\n\n  if (isWeb) {\n    return <View style={[styles.previewWrapper, previewWrapperWebStyle, style]}>{children}</View>;\n  }\n\n  return (\n    <ImageBackground\n      source={require('../assets/transparent-texture.png')}\n      imageStyle={{ width: '100%', height: '100%' }}\n      resizeMode='repeat'\n      style={[styles.previewWrapper, style]}\n    >\n      {children}\n    </ImageBackground>\n  );\n}\n\nconst previewWrapperWebStyle = {\n  backgroundImage:\n    'repeating-linear-gradient(45deg, #c1c1c1 25%, transparent 25%, transparent 75%, #c1c1c1 75%, #c1c1c1), repeating-linear-gradient(45deg, #c1c1c1 25%, #fff 25%, #fff 75%, #c1c1c1 75%, #c1c1c1)',\n  backgroundPosition: '0px 0px, 8px 8px',\n  backgroundSize: '16px 16px',\n} as StyleProp<ViewStyle>;\n"],"mappings":"AAAA,OAAOA,KAAK,IAAIC,OAAO,QAAQ,OAAO;AACtC,SAASC,eAAe,EAAEC,IAAI,EAAEC,IAAI,QAAQ,cAAc;AAC1D,OAAOC,QAAQ,IAAIC,gBAAgB,EAAEC,eAAe,EAAEC,cAAc,QAAQ,yBAAyB;AAErG,OAAOC,QAAQ;AACf,OAAOC,gBAAgB;AACvB,SAASC,MAAM;AACf,SAASC,oBAAoB,EAAEC,QAAQ,EAAEC,KAAK;AAC9C,SAASC,WAAW;AAMpB,OAAO,SAASC,OAAOA,CAAC;EACtBC,KAAK,GAAG,CAAC,CAAC;EACVC,SAAS,GAAG,CAAC,CAAC;EACdC,WAAW,GAAG,KAAK;EACnBC,gBAAgB,GAAG,KAAK;EACxBC,QAAQ,GAAG,KAAK;EAChBC,qBAAqB,GAAG;AACZ,CAAC,EAAE;EACf,MAAM;IAAEC,QAAQ;IAAEC,eAAe;IAAEC,eAAe;IAAEC,UAAU;IAAEC,eAAe;IAAEC;EAAM,CAAC,GAAGlB,gBAAgB,CAAC,CAAC;EAE7G,MAAMmB,cAAc,GAAGhB,QAAQ,CAACI,KAAK,EAAE,gBAAgB,CAAC,IAAI,QAAQ;EAEpE,MAAMa,gBAAgB,GAAG7B,OAAO,CAAC,MAAM;IACrC,MAAM8B,iBAAiB,GAAGL,UAAU,CAACE,KAAK,GAAG,GAAG,GAAGA,KAAK,GAAG;MAAEI,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAG,CAAC;IAChF,MAAMC,QAAQ,GAAG1B,QAAQ,CAAC2B,aAAa,CAACL,iBAAiB,EAAE,SAAS,CAAC;IACrE,MAAMM,KAAK,GAAGF,QAAQ,GAAG,GAAG,GAAG,SAAS,GAAG,SAAS;IACpD,OAAO;MAAEG,SAAS,EAAEX,eAAe,CAAC,CAAC,CAACR,WAAW,CAAC;MAAEkB;IAAM,CAAC;EAC7D,CAAC,EAAE,CAACT,KAAK,EAAET,WAAW,CAAC,CAAC;EAExB,MAAMoB,SAAS,GAAG/B,cAAc,CAAwB,SAAS,CAAC;EAClE,MAAMgC,cAAc,GAAGlC,gBAAgB,CAAC,OAAO;IAAE+B,KAAK,EAAEE,SAAS,CAACX;EAAM,CAAC,CAAC,EAAE,CAACW,SAAS,CAAC,CAAC;EAExF,MAAME,YAAY,GAAGjC,cAAc,CAAC,SAAS,CAAC;EAC9C,MAAMkC,iBAAiB,GAAGpC,gBAAgB,CAAC,OAAO;IAAEqC,eAAe,EAAEF,YAAY,CAACb;EAAM,CAAC,CAAC,EAAE,CAACa,YAAY,CAAC,CAAC;;EAE3G;EACAlC,eAAe,CAAC,MAAM;IACpB,MAAMqC,YAAY,GAAG;MAAEZ,CAAC,EAAET,QAAQ,CAACK,KAAK;MAAEK,CAAC,EAAET,eAAe,CAACI,KAAK;MAAEM,CAAC,EAAET,eAAe,CAACG,KAAK;MAAEiB,CAAC,EAAEnB,UAAU,CAACE;IAAM,CAAC;IAEnHa,YAAY,CAACb,KAAK,GAAGnB,QAAQ,CAC1BqC,OAAO,CAAC,CAAC,CACTC,GAAG,CAAC;MAAEf,CAAC,EAAET,QAAQ,CAACK,KAAK;MAAEK,CAAC,EAAET,eAAe,CAACI,KAAK;MAAEM,CAAC,EAAET,eAAe,CAACG,KAAK;MAAEiB,CAAC,EAAEnB,UAAU,CAACE;IAAM,CAAC,CAAC;;IAEtG;IACA,MAAMoB,aAAa,GAAGtB,UAAU,CAACE,KAAK,GAAG,GAAG,GAAGgB,YAAY,GAAG;MAAEZ,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAG,CAAC;IACnF,MAAMe,aAAa,GAAGV,SAAS,CAACX,KAAK,KAAK,SAAS,GAAG;MAAEI,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAE,CAAC,GAAG;MAAEF,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAI,CAAC;IACnG,MAAMC,QAAQ,GAAG1B,QAAQ,CAACqC,OAAO,CAAC,CAAC,CAACV,aAAa,CAACY,aAAa,EAAEC,aAAa,CAAC;IAC/E,MAAMC,aAAa,GAAGX,SAAS,CAACX,KAAK,KAAK,SAAS,GAAG,SAAS,GAAG,SAAS;IAC3EW,SAAS,CAACX,KAAK,GAAGO,QAAQ,GAAG,GAAG,GAAGe,aAAa,GAAGX,SAAS,CAACX,KAAK;EACpE,CAAC,EAAE,CAACL,QAAQ,EAAEC,eAAe,EAAEC,eAAe,EAAEC,UAAU,CAAC,CAAC;EAE5D,oBACE1B,KAAA,CAAAmD,aAAA,CAACC,OAAO;IAACC,cAAc,EAAE/B,qBAAsB;IAACL,KAAK,EAAEA;EAAM,gBAC3DjB,KAAA,CAAAmD,aAAA,CAACvC,oBAAoB;IAAC0C,EAAE,EAAE,CAAClC;EAAiB,gBAC1CpB,KAAA,CAAAmD,aAAA,CAAC/C,IAAI;IAACa,KAAK,EAAE,CAACN,MAAM,CAAC4C,gBAAgB,EAAE;MAAEZ,eAAe,EAAEf,KAAK;MAAEC;IAAe,CAAC;EAAE,gBACjF7B,KAAA,CAAAmD,aAAA,CAACvC,oBAAoB;IAAC0C,EAAE,EAAE,CAACjC;EAAS,gBAClCrB,KAAA,CAAAmD,aAAA,CAAChD,IAAI;IAACc,KAAK,EAAE,CAACN,MAAM,CAAC6C,WAAW,EAAE;MAAEnB,KAAK,EAAEP,gBAAgB,CAACO;IAAM,CAAC,EAAEnB,SAAS;EAAE,GAAEY,gBAAgB,CAACQ,SAAgB,CAC/F,CAClB,CACc,CAAC,eAEvBtC,KAAA,CAAAmD,aAAA,CAAC9C,QAAQ,CAACD,IAAI;IAACa,KAAK,EAAE,CAACN,MAAM,CAAC4C,gBAAgB,EAAE;MAAE1B;IAAe,CAAC,EAAEa,iBAAiB;EAAE,gBACrF1C,KAAA,CAAAmD,aAAA,CAACvC,oBAAoB;IAAC0C,EAAE,EAAE,CAACjC;EAAS,gBAClCrB,KAAA,CAAAmD,aAAA,CAACpC,WAAW;IAACI,WAAW,EAAEA,WAAY;IAACF,KAAK,EAAE,CAACC,SAAS,EAAEsB,cAAc;EAAE,CAAE,CACxD,CACT,CACR,CAAC;AAEd;AAQA,SAASY,OAAOA,CAAC;EAAEK,QAAQ;EAAEJ,cAAc;EAAEpC;AAAoB,CAAC,EAAE;EAClE,IAAIoC,cAAc,EAAE;IAClB,oBAAOrD,KAAA,CAAAmD,aAAA,CAAC/C,IAAI;MAACa,KAAK,EAAE,CAACN,MAAM,CAAC+C,cAAc,EAAEzC,KAAK;IAAE,GAAEwC,QAAe,CAAC;EACvE;EAEA,IAAI3C,KAAK,EAAE;IACT,oBAAOd,KAAA,CAAAmD,aAAA,CAAC/C,IAAI;MAACa,KAAK,EAAE,CAACN,MAAM,CAAC+C,cAAc,EAAEC,sBAAsB,EAAE1C,KAAK;IAAE,GAAEwC,QAAe,CAAC;EAC/F;EAEA,oBACEzD,KAAA,CAAAmD,aAAA,CAACjD,eAAe;IACd0D,MAAM,EAAEC,OAAO,oCAAoC,CAAE;IACrDC,UAAU,EAAE;MAAEC,KAAK,EAAE,MAAM;MAAEC,MAAM,EAAE;IAAO,CAAE;IAC9CC,UAAU,EAAC,QAAQ;IACnBhD,KAAK,EAAE,CAACN,MAAM,CAAC+C,cAAc,EAAEzC,KAAK;EAAE,GAErCwC,QACc,CAAC;AAEtB;AAEA,MAAME,sBAAsB,GAAG;EAC7BO,eAAe,EACb,gMAAgM;EAClMC,kBAAkB,EAAE,kBAAkB;EACtCC,cAAc,EAAE;AAClB,CAAyB"}